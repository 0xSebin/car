---
title: Credentials in Registry
submission_date: 2020/08/31
information_domain: 'Host'
platforms:
  - Windows
subtypes:
  - Process 
  - Registry
analytic_types:
  - TTP
contributors:
- Olaf Hartong
id: CAR-2020-08-006
description: |-
  Adversaries may search the Windows Registry on compromised systems for insecurely stored credentials for credential access. This can be accomplished using the query functionality of the reg.exe system utility, by looking for keys and values that contain strings such as "password". Accordingly, this analytic looks for invocations of reg.exe in this capacity as well as several powersploit modules with similar functionality.
coverage:
- coverage: Low
  subtechniques: 
    - T1552.002
  tactics: 
    - TA0031
  technique: T1552
implementations:
- name: Splunk Search
  description: This Splunk search looks for command lines of reg.exe used to search for passwords, as well as those of powersploit modules for the same purpose.
  code: |- 
    ((index=__your_sysmon_index__ EventCode=1) OR (index=__your_win_syslog_index__ EventCode=4688)) (CommandLine="*reg* query HKLM /f password /t REG_SZ /s*" OR CommandLine="reg* query HKCU /f password /t REG_SZ /s" OR CommandLine="*Get-UnattendedInstallFile*" OR CommandLine="*Get-Webconfig*" OR CommandLine="*Get-ApplicationHost*" OR CommandLine="*Get-SiteListPassword*" OR CommandLine="*Get-CachedGPPPassword*" OR CommandLine="*Get-RegistryAutoLogon*") 
  data_model: Sysmon native
  type: Splunk

