---
title: Indicator Blocking - Driver Unloaded
submission_date: 2020/09/10
information_domain: 'Host'
platforms:
  - Windows
subtypes: 
  - Process
analytic_types:
  - TTP
contributors:
  - Olaf Hartong
id: CAR-2020-09-003
description: |-
  Adversaries may attempt to devade system defenses by unloading minifilter drivers used by host-based sensors such as Sysmon through the use of the fltmc command-line utility. Accordingly, this analytic looks for command-line invocations of this utility when used to unload minifilter drivers.
coverage:
- coverage: Low
  subtechniques: 
    - T1562.006
  tactics: 
    - TA0030
  technique: T1562
implementations:
- name: Pseudocode - fltmc invocation
  description: This is a pseudocdoe representation of the below splunk search.
  code: |- 
    processes = search Process:Create
    fltmc_processes = filter processes where (
      exe = "fltmc.exe" OR command_line = "*fltmc*unload*")
    output fltmc_processes
  data_model: CAR native
  type: Pseudocode
- name: Splunk search - fltmc invocation
  description: This Splunk search looks for process create events for the fltmc.exe utility and the specific command line used to unload minifilter drivers.
  code: |- 
    index=client EventCode=1 (Image="C:\\Windows\\SysWOW64\\fltMC.exe" OR Image="C:\\Windows\\System32\\fltMC.exe") OR CommandLine="*fltmc*unload*"
  data_model: Sysmon native
  type: Splunk
- data_model_references:
  - process/create/exe
  - process/create/command_line


